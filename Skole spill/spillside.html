<!DOCTYPE html>
<html>

<head>


    <link href='https://fonts.googleapis.com/css?family=MedievalSharp' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="./css/spillside.css">

    <title>KJELLEREN PÅ AFR</title>
    <style>
    </style>

<script src="js/spillet.js"></script>
    <script src="js/spillside.js"></script>

    <script>
        // Her er alle rom definert
        var romnr = 0;  // utgangspunkt
        var viewnr = 1;
        var areanr = 0;
        var rom = [
            {
                view: [
                    {
                        img: "./provebilder/provebilder_ferdig/Left0_ferdig.jpg",
                        areas: [{
                            coords: "442,247,443,234,483,234,479,174,414,174,349,174,351,233,408,233,409,246",
                            kode: 1,
                            type: "bilde",
                            img: "./provebilder/provebilder_ferdig/CloseupTaskLeft0_ferdig.jpg",
                            message: "Dette er sifferet"
                        }]
                    },
                    {
                        img: "./provebilder/Door0.JPG",
                        areas: [{
                            coords: "370,577,671,575,662,14,367,24",
                            kode: 1111,
                            type: "dør",
                            laast: true,
                            nesterom: 1,
                            message: "Dette er døren"
                        }]
                    },
                    {
                        img: "./provebilder/provebilder_ferdig/Right0_ferdig.jpg",
                        areas: [{
                            coords: "380,389,381,401,404,403,404,389",
                            kode: 1,
                            type: "bilde",
                            img: "./provebilder/provebilder_ferdig/Closeup0Tabell_ferdig.jpg",
                            message: "Dette er diagrammet"
                        }]
                    }
                ],
                startview: 1
            },
            {
                view: [
                    {
                        img: "./provebilder/provebilder_ferdig/Left1_ferdig.JPG",
                        areas: [{
                            coords: "570,314,570,335,583,343,600,339,671,307,668,286,657,279",
                            kode: 1,
                            type: "bilde",
                            img: "./provebilder/provebilder_ferdig/CloseupClueLeft1_ferdig.JPG",
                            message: "Dette er esken"
                        }]
                    },
                    {
                        img: "./provebilder/provebilder_ferdig/Door1_ferdig.JPG",
                        areas: [{
                            coords: "475,117,602,119,601,376,475,374",
                            kode: 12,
                            type: "dør",
                            laast: true,
                            nesterom: 2,
                            message: "Dette er døren"

                        },
                        {
                            coords: "799,577,847,578,843,97,910,3,795,3",
                            kode: 1,
                            type: "bilde",
                            img: "./provebilder/Left1.JPG",
                            message: "Dette er røret"
                        }],
                        sistrom: 0
                    },

                    {
                        img: "./provebilder/provebilder_ferdig/Right1_ferdig.JPG",
                        areas: [{
                            coords: "80,310,133,314,164,271,159,220,106,211,64,244",
                            kode: 1,
                            type: 1,
                            message: "Dette er esken"
                        }]
                    }
                ],
                startview: 1
            },
            {
                view: [
                    {
                        img: "./provebilder/provebilder_ferdig/Left0_ferdig.JPG",
                        areas: [{
                        }]
                    },
                    {
                        img: "./provebilder/provebilder_ferdig/Door0_ferdig.JPG",
                        areas: [{
                            coords: "475,117,602,119,601,376,475,374",
                            kode: 1,
                            type: "dør",
                            laast: true,
                            nesterom: 3,
                            message: "Dette er døren"

                        }],
                        sistrom: 1
                    },

                    {
                        img: "./provebilder/provebilder_ferdig/Right0_ferdig.JPG",
                        areas: [{

                        }]
                    }
                ],
                startview: 1
            }
        ];
        var hint = [{
            tekst: "Hint 1",
            tid: 5000
        }, {
            tekst: "Hint 2",
            tid: 10000
        }, {
            tekst: "Hint 3",
            tid: 15000
        }, {
            tekst: "Hint 4",
            tid: 20000
        }, {
            tekst: "Hint 5",
            tid: 100000
        }];

        // helper som lager area-html'en til mappen
        function getArea(inner, romnr, viewnr, areanr) {
            return "<area shape='poly' coords='" + inner + "' onclick=\"sjekkType(" + romnr + ", " + viewnr + ", " + areanr + ")\">";
        }

        function sjekkType(Rnr, Vnr, Anr) {
            romnr = Rnr;
            viewnr = Vnr;
            areanr = Anr;
            var view = rom[Rnr].view[Vnr].areas[Anr];
            if (view.type == "dør") {
                if (view.laast) {
                    document.getElementById('ModalSafe').style.display = "block";
                    document.getElementById("kodesynlig").style.display = "block";
                } else {
                    last_rom(view.nesterom);

                }
            } else if (view.type == "bilde") {
                document.getElementById('myModal').style.display = "block";
                document.getElementById("detailedinfo").innerHTML = "<img src='" + view.img + "'>";
            }
        }

        function last_rom(nr) {
            var rommet = rom[nr];
            var view = rommet.view[rommet.startview];
            romnr = nr;
            viewnr = rommet.startview;
            nytt_view(viewnr)
        }

        function nytt_view(view_nr) {
            var rommet = rom[romnr]; // samme rom som før
            var view = rommet.view[view_nr];
            viewnr = view_nr;
            document.getElementById("hovedbilde").src = view.img;
            var resultat = ""
            for (var i = 0; i < view.areas.length; i++) {
                resultat = resultat + getArea(view.areas[i].coords, romnr, viewnr, i)
            }
            document.getElementById("Map").innerHTML = resultat
            if (typeof view.sistrom === 'undefined') {
                document.getElementById("tilbake").style.display = "none";
            } else {
                document.getElementById("tilbake").style.display = "block";
            }
        }

        function vis(ting) {

            document.getElementById("detalj").style.visibility = "visible";
            document.getElementById("detalj").innerHTML = ting;
        }
        function skjul() {
            document.getElementById("detalj").style.visibility = "hidden"
        }

        var sek = 3600;

        var fortsett = true;

        function tell() {
            if (fortsett) {
                sek = sek - 1;
                skrivtid(sek);
                setTimeout(tell, 1000);
                if (sek < 1) {
                    fortsett = false;
                }
            }
        }
        window.onload = startup;


        function startup() {
            setTimeout(tell, 1000);
            setupHint();
        }


        function tallTilTekst(tall) {
            //Sekunder og minutter som tekst
            if (tall < 10) {
                return "0" + tall;
            } else {
                return tall;
            }
            return "" + tall;
        }

        function skrivtid(tid) {
            var minutter = 0;
            var sekunder = 0;

            //regn ut minutter og sekunder
            minutter = Math.floor(tid / 60);
            sekunder = tid - 60 * minutter;

            document.getElementById("klokke").innerHTML = tallTilTekst(minutter) + " " + ":" + " " + tallTilTekst(sekunder);
        }

        function hoyre() {

            viewnr = viewnr + 1;

            if (viewnr == 2) {
                document.getElementById("mothoyre").style.display = "none";
            } else {
                document.getElementById("mothoyre").style.display = "inline-block";
            }
            document.getElementById("motvenstre").style.display = "inline-block";
            nytt_view(viewnr);


        }

        function venstre() {
            viewnr = viewnr - 1;

            if (viewnr == 0) {
                document.getElementById("motvenstre").style.display = "none";
            } else {
                document.getElementById("motvenstre").style.display = "inline-block";
            }
            document.getElementById("mothoyre").style.display = "inline-block";
            nytt_view(viewnr);
        }

        function tilbake() {
            var view = rom[romnr].view[viewnr];
            last_rom(view.sistrom);
        }

        function setupHint() {
            for (var i = 0; i < hint.length; i++) {
                setTimeout(skrivHint, hint[i].tid, hint[i].tekst);
            }
        }
        function skrivHint(tekst) {
            document.getElementById("hint").innerHTML = tekst;
        }

        function NyttNavn() {
            var element = {
                navn: document.getElementById("navnet").value,
                tid: 0
            }
            var navn = document.getElementById("navn").innerHTML = "Brukernavn: " + element.navn + "";
            console.log(element);
            
        }
    </script>

    <script>


        var resultatTekst = "";

        function skriv() {

            document.getElementById("resultat").innerHTML = resultatTekst;

        }

        function klikk(verdi) {

            resultatTekst += verdi;
            skriv();
        }

        function kommando(verdi) {

            if (verdi == "C") {
                reset();
            }
        }

        function reset() {

            resultatTekst = "";
            skriv();

        }

        function resultat() {
            var area = rom[romnr].view[viewnr].areas[areanr];
            if (Number(resultatTekst) == Number(area.kode)) {

                last_rom(area.nesterom);
                area.laast = false;
                document.getElementById('ModalSafe').style.display = "none";

            }
            else {
                alert("FEIL");
            }
            reset();
        }
    </script>


</head>

<body>
    <!--Navbar-->
    <div id="topp">
        <div id="navn"><input id="navnet" type="text"><button id="knapp" onclick="NyttNavn()">Send inn</button></div>
        <div id="klokke">60 : 00</div>
        <div id="hint"><div id="hintTekst">hint</div>
        <input onclick="fjernHint()" id="taVekk" type="checkbox"></input></div>
    </div>

    <div id="overskrift">
        <h1>KJELLERN PÅ AFR</h1>
    </div>

    <!--Spillet-->
    <div id="hoved">
            <div id="motvenstre" onclick="venstre()"><span class="piler" id="venstre">&#8249;</span></div>

        <div id="spill">
            <div id=hovedbildeytter><img id="hovedbilde" height="578" width="1028" usemap="#Map"></div>
            <map name="Map" id="Map">
                <area alt="" title="" href="#" shape="poly" coords="77,311,135,317,166,275,161,225,109,217,67,248"
                    onclick="vis('boks')" />
                <area alt="" title="" href="#" shape="poly" coords="153,149,159,217,244,224,246,156"
                    onclick="vis('kjoleskap')" />
            </map>
            <center>
                <div id="tilbake" class="rotate" onclick="tilbake()"><span class="piler" id="nedtilbake">&#8250;</span></div>
            </center>
        
        </div>
        <div id="mothoyre" onclick="hoyre()"><span class="piler" id="hoyre">&#8250;</span></div>


    </div>
    <!--Detaljebilder-->
    <div id="detalj" onclick="skjul()">detalj</div>
    <!--Boks der info om deljebilder eller lås vises i-->
    <div id="container">
        <div id="imagearea">
        </div>
        <div id="descriptionarea">
        </div>
    </div>
    <div id="myModal" class="modal">

        <!-- Kode content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="detailedinfo"></div>
        </div>
    </div>

    <div id="ModalSafe" class="modal">

        <!-- Kode content -->
        <div class="modal-contentdoor">
            <span class="close">&times;</span>
            <div id="kodesynlig">

                <div class="posisjon" maxlength="4" id="resultat"></div><br><br>
                <button class="knapp" onclick="klikk('1')">1</button>
                <button class="knapp" onclick="klikk('2')">2</button>
                <button class="knapp" onclick="klikk('3')">3</button>
                <br>
                <button class="knapp" onclick="klikk('4')">4</button>
                <button class="knapp" onclick="klikk('5')">5</button>
                <button class="knapp" onclick="klikk('6')">6</button>
                <br>
                <button class="knapp" onclick="klikk('7')">7</button>
                <button class="knapp" onclick="klikk('8')">8</button>
                <button class="knapp" onclick="klikk('9')">9</button>
                <br>
                <button class="knapp" onclick="klikk('0')">0</button>
                <button class="knapp" onclick="kommando('C')">C</button>
                <br><br>
                <button onclick="resultat()" class="knapp" id="resultat">Lås opp</button><br><br>

            </div>
        </div>
    </div>

    <script>
        last_rom(0);
    </script>
</body>

</html>